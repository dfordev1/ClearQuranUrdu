<!DOCTYPE html>
<html lang="ur" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>قرآن ایپ - اردو</title>
    <style>
        body {
            font-family: 'Amiri', 'Scheherazade New', 'Traditional Arabic', Arial, sans-serif;
            margin: 20px;
            background-color: #f5f5f5;
        }
        .container {
            max-width: 800px;
            margin: 0 auto;
            background-color: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        h1 {
            text-align: center;
            color: #43a047;
            margin-bottom: 30px;
        }
        select {
            padding: 8px;
            margin: 10px 0;
            width: 100%;
            border-radius: 4px;
            border: 1px solid #ddd;
        }
        label {
            font-weight: bold;
            color: #555;
        }
        #verses {
            margin-top: 20px;
            border-top: 1px solid #eee;
            padding-top: 20px;
        }
        #verses p {
            padding: 10px;
            border-bottom: 1px solid #f0f0f0;
            line-height: 1.6;
        }
        .verse-number {
            font-weight: bold;
            color: #43a047;
            margin-left: 8px;
        }
        .loading {
            text-align: center;
            margin: 50px 0;
            font-size: 18px;
            color: #666;
        }
        .error {
            color: #e53935;
            text-align: center;
            margin: 20px 0;
            padding: 10px;
            border: 1px solid #ffcdd2;
            background-color: #ffebee;
            border-radius: 4px;
        }
    </style>
    <script>
        let quranData = { Chapters: [], "Verses Urdu": [] };
        let themesData = { "Themes of Quran": [] };
        let isLoading = true;
        let errorMessage = "";

        async function loadJSON() {
            try {
                document.getElementById('app-container').innerHTML = '<div class="loading">جاری ہے... براۓ مہربانی انتظار کریں</div>';
                
                // Load Quran data
                const quranResponse = await fetch('quran.json');
                if (!quranResponse.ok) throw new Error('quran.json لوڈ نہیں ہوسکا');
                const quran = await quranResponse.json();
                quranData.Chapters = quran.Chapters || [];
                quranData["Verses Urdu"] = quran["Verses Urdu"] || [];
                
                // Load themes data
                const themesResponse = await fetch('themes.json');
                if (!themesResponse.ok) throw new Error('themes.json لوڈ نہیں ہوسکا');
                const themes = await themesResponse.json();
                themesData["Themes of Quran"] = themes["Themes of Quran"] || [];
                
                isLoading = false;
                initializeApp();
            } catch (error) {
                console.error('Error:', error);
                errorMessage = error.message;
                isLoading = false;
                showError();
            }
        }

        function showError() {
            document.getElementById('app-container').innerHTML = `
                <div class="error">
                    <p>ایرر: ${errorMessage}</p>
                    <p>براہ کرم چیک کریں کہ JSON فائلیں موجود ہیں اور درست ہیں</p>
                </div>
            `;
        }

        function initializeApp() {
            document.getElementById('app-container').innerHTML = `
                <h1>قرآن ایپ - اردو</h1>
                <div>
                    <label>سورة منتخب کریں:</label>
                    <select id="chapter" onchange="showVerses()"></select>
                </div>
                <div>
                    <label>موضوع منتخب کریں:</label>
                    <select id="theme" onchange="showThemeVerses()"></select>
                </div>
                <div id="verses"></div>
            `;

            populateChapters();
            populateThemes();
            if (quranData.Chapters.length > 0) {
                document.getElementById('chapter').value = quranData.Chapters[0].number;
                showVerses();
            }
        }

        function populateChapters() {
            const chapterSelect = document.getElementById('chapter');
            chapterSelect.innerHTML = quranData.Chapters.map(chapter => `
                <option value="${chapter.number}">سورة ${chapter.name}</option>
            `).join('');
        }

        function populateThemes() {
            const themeSelect = document.getElementById('theme');
            themeSelect.innerHTML = themesData["Themes of Quran"].map(theme => `
                <option value="${theme.theme_name_Urdu}">${theme.theme_name_Urdu}</option>
            `).join('');
        }

        function showVerses() {
            const chapterNumber = parseInt(document.getElementById('chapter').value);
            const versesDiv = document.getElementById('verses');
            const chapter = quranData.Chapters.find(c => c.number === chapterNumber);
            
            versesDiv.innerHTML = `<h2>سورة ${chapter.name}</h2>`;
            
            const verses = quranData["Verses Urdu"].filter(v => v.chapter_number === chapterNumber);
            if (verses.length === 0) {
                versesDiv.innerHTML += '<p>کوئی آیات دستیاب نہیں</p>';
                return;
            }

            versesDiv.innerHTML += verses.map(verse => `
                <p>
                    <span class="verse-number">${verse.verse_number}</span>
                    ${verse.text_urdu}
                </p>
            `).join('');
        }

        function showThemeVerses() {
            const themeName = document.getElementById('theme').value;
            const versesDiv = document.getElementById('verses');
            const theme = themesData["Themes of Quran"].find(t => t.theme_name_Urdu === themeName);
            
            versesDiv.innerHTML = `<h2>موضوع: ${themeName}</h2>`;
            
            const verses = quranData["Verses Urdu"].filter(v => 
                v.chapter_number === theme.chapter_number &&
                v.verse_number >= theme.start_verse &&
                v.verse_number <= theme.end_verse
            );

            if (verses.length === 0) {
                versesDiv.innerHTML += '<p>کوئی آیات دستیاب نہیں</p>';
                return;
            }

            versesDiv.innerHTML += verses.map(verse => `
                <p>
                    <span class="verse-number">${verse.chapter_number}:${verse.verse_number}</span>
                    ${verse.text_urdu}
                </p>
            `).join('');
        }

        window.onload = loadJSON;
    </script>
</head>
<body>
    <div id="app-container" class="container">
        <div class="loading">جاری ہے... براۓ مہربانی انتظار کریں</div>
    </div>
</body>
</html>
