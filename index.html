<!DOCTYPE html>
<html lang="ur" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Quran App - Urdu</title>
    <style>
        body {
            font-family: 'Amiri', 'Scheherazade New', 'Traditional Arabic', Arial, sans-serif;
            margin: 20px;
            background-color: #f5f5f5;
        }
        .container {
            max-width: 800px;
            margin: 0 auto;
            background-color: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        h1 {
            text-align: center;
            color: #43a047;
            margin-bottom: 30px;
        }
        select {
            padding: 8px;
            margin: 10px 0;
            width: 100%;
            border-radius: 4px;
            border: 1px solid #ddd;
        }
        label {
            font-weight: bold;
            color: #555;
        }
        #verses {
            margin-top: 20px;
            border-top: 1px solid #eee;
            padding-top: 20px;
        }
        #verses p {
            padding: 10px;
            border-bottom: 1px solid #f0f0f0;
            line-height: 1.6;
        }
        .verse-number {
            font-weight: bold;
            color: #43a047;
            margin-left: 8px;
        }
        .loading {
            text-align: center;
            margin: 50px 0;
            font-size: 18px;
            color: #666;
        }
        .error {
            color: #e53935;
            text-align: center;
            margin: 20px 0;
            padding: 10px;
            border: 1px solid #ffcdd2;
            background-color: #ffebee;
            border-radius: 4px;
        }
    </style>
    <script>
        // Global variables to store our data
        let quranData = { chapters: [], verses: [] };
        let themesData = { themes: [] };
        let isLoading = true;
        let errorMessage = "";

        // Function to load JSON data
        async function loadJSON() {
            try {
                // Display loading message
                document.getElementById('app-container').innerHTML = '<div class="loading">جاری ہے... براۓ مہربانی انتظار کریں</div>';
                
                // Fetch Quran data
                const quranResponse = await fetch('quran.json');
                if (!quranResponse.ok) {
                    throw new Error('quran.json فائل لوڈ نہیں ہوسکی');
                }
                quranData = await quranResponse.json();
                
                // Fetch themes data
                const themesResponse = await fetch('themes.json');
                if (!themesResponse.ok) {
                    throw new Error('themes.json فائل لوڈ نہیں ہوسکی');
                }
                themesData = await themesResponse.json();
                
                // Data loaded successfully
                isLoading = false;
                
                // Initialize the app
                initializeApp();
            } catch (error) {
                console.error('Error loading data:', error);
                errorMessage = error.message;
                isLoading = false;
                showError();
            }
        }

        // Function to show error message
        function showError() {
            document.getElementById('app-container').innerHTML = `
                <div class="error">
                    <p>ایرر: ${errorMessage}</p>
                    <p>براہ کرم یقینی بنائیں کہ quran.json اور themes.json فائلیں موجود ہیں۔</p>
                </div>
            `;
        }

        // Function to initialize the app
        function initializeApp() {
            // Render the app UI
            document.getElementById('app-container').innerHTML = `
                <h1>قرآن ایپ - اردو</h1>
                
                <div>
                    <label>سورة منتخب کریں:</label>
                    <select id="chapter" onchange="showVerses()"></select>
                </div>
                
                <div>
                    <label>موضوع منتخب کریں:</label>
                    <select id="theme" onchange="showThemeVerses()"></select>
                </div>
                
                <div id="verses"></div>
            `;
            
            // Populate dropdowns
            populateChapters();
            populateThemes();
            
            // Show Al-Fatiha by default (if available)
            if (quranData.chapters && quranData.chapters.length > 0) {
                document.getElementById('chapter').value = quranData.chapters[0].number;
                showVerses();
            }
        }

        function populateChapters() {
            let chapterSelect = document.getElementById('chapter');
            chapterSelect.innerHTML = '';
            
            if (quranData.chapters && quranData.chapters.length > 0) {
                quranData.chapters.forEach(chapter => {
                    let option = document.createElement('option');
                    option.value = chapter.number;
                    option.textContent = `سورة ${chapter.name}`;
                    chapterSelect.appendChild(option);
                });
            }
        }

        function populateThemes() {
            let themeSelect = document.getElementById('theme');
            themeSelect.innerHTML = '';
            
            if (themesData.themes && themesData.themes.length > 0) {
                themesData.themes.forEach(theme => {
                    let option = document.createElement('option');
                    option.value = theme.name;
                    option.textContent = theme.name;
                    themeSelect.appendChild(option);
                });
            }
        }

        function showVerses() {
            let chapterNumber = parseInt(document.getElementById('chapter').value);
            let versesDiv = document.getElementById('verses');
            versesDiv.innerHTML = '';
            
            // Find chapter name
            let chapter = quranData.chapters.find(c => c.number === chapterNumber);
            if (!chapter) return;
            
            // Add chapter title
            let chapterTitle = document.createElement('h2');
            chapterTitle.textContent = `سورة ${chapter.name}`;
            versesDiv.appendChild(chapterTitle);
            
            // Filter verses for this chapter
            let verses = quranData.verses.filter(v => v.chapter_number === chapterNumber);
            
            // Display verses
            if (verses.length === 0) {
                versesDiv.innerHTML += '<p>اس سورة کے لیے کوئی آیات نہیں ہیں</p>';
                return;
            }
            
            verses.forEach(verse => {
                let p = document.createElement('p');
                let span = document.createElement('span');
                span.className = 'verse-number';
                span.textContent = verse.verse_number;
                p.appendChild(span);
                p.innerHTML += ` ${verse.text_urdu}`;
                versesDiv.appendChild(p);
            });
        }

        function showThemeVerses() {
            let themeName = document.getElementById('theme').value;
            let versesDiv = document.getElementById('verses');
            versesDiv.innerHTML = '';
            
            // Find the selected theme
            let theme = themesData.themes.find(t => t.name === themeName);
            if (!theme) return;
            
            // Add theme title
            let themeTitle = document.createElement('h2');
            themeTitle.textContent = `موضوع: ${themeName}`;
            versesDiv.appendChild(themeTitle);
            
            // Filter verses for this theme
            let verses = quranData.verses.filter(v => 
                v.chapter_number === theme.chapter_number && 
                v.verse_number >= theme.start_verse && 
                v.verse_number <= theme.end_verse
            );
            
            // Display verses
            if (verses.length === 0) {
                versesDiv.innerHTML += '<p>اس موضوع کے لیے کوئی آیات نہیں ہیں</p>';
                return;
            }
            
            verses.forEach(verse => {
                let p = document.createElement('p');
                
                // Find chapter name for reference
                let chapter = quranData.chapters.find(c => c.number === verse.chapter_number);
                let chapterName = chapter ? chapter.name : verse.chapter_number;
                
                let span = document.createElement('span');
                span.className = 'verse-number';
                span.textContent = `${chapterName} ${verse.verse_number}:`;
                p.appendChild(span);
                
                p.innerHTML += ` ${verse.text_urdu}`;
                versesDiv.appendChild(p);
            });
        }

        // Start loading when page loads
        window.onload = loadJSON;
    </script>
</head>
<body>
    <div id="app-container" class="container">
        <div class="loading">جاری ہے... براۓ مہربانی انتظار کریں</div>
    </div>
</body>
</html>
